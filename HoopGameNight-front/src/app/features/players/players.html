<div class="players-page">
  <div class="players-container">
    <div class="players-header">
    <h1>
      <span class="material-icons">sports_basketball</span>
      Jogadores NBA
    </h1>
    <p class="subtitle">Encontre e explore jogadores da NBA</p>
  </div>

  <!-- Search and Filters -->
  <div class="filters-section">
    <div class="search-box">
      <span class="material-icons search-icon">search</span>
      <input
        type="text"
        placeholder="Buscar jogador (ex: LeBron, Curry, Durant...)"
        [ngModel]="searchInput()"
        (ngModelChange)="updateSearchInput($event)"
        (keyup.enter)="onSearch()"
        class="search-input"
      />
      @if (searchInput().length > 0) {
        <button class="clear-btn" (click)="clearFilters()">
          <span class="material-icons">close</span>
        </button>
      }
      <button class="search-btn" (click)="onSearch()" [disabled]="searchInput().length < 2">
        Buscar
      </button>
    </div>

    <div class="filter-row">
      <div class="position-filters">
        <button
          class="filter-btn"
          [class.active]="selectedPositionFilter() === ''"
          (click)="onPositionFilter('')"
        >
          Todos
        </button>
        @for (position of positions; track position) {
          <button
            class="filter-btn"
            [class.active]="selectedPositionFilter() === position"
            (click)="onPositionFilter(position)"
          >
            {{ position }}
          </button>
        }
      </div>

      <div class="view-toggle">
        <button
          class="view-btn"
          [class.active]="viewMode() === 'grid'"
          (click)="setViewMode('grid')"
        >
          <span class="material-icons">grid_view</span>
        </button>
        <button
          class="view-btn"
          [class.active]="viewMode() === 'list'"
          (click)="setViewMode('list')"
        >
          <span class="material-icons">view_list</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Results Info -->
  @if (playersService.hasSearchResults()) {
    <div class="results-info">
      <span class="results-count">
        {{ playersService.pagination().totalCount }} jogadores encontrados
      </span>
      @if (playersService.searchQuery()) {
        <span class="search-term">para "{{ playersService.searchQuery() }}"</span>
      }
      @if (playersService.selectedPosition()) {
        <span class="position-term">- Posição: {{ getPositionName(playersService.selectedPosition()) }}</span>
      }
    </div>
  }

  <!-- Loading -->
  @if (playersService.isLoading()) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>Carregando jogadores...</p>
    </div>
  }

  <!-- Error -->
  @if (playersService.error()) {
    <div class="error-container">
      <span class="material-icons">error_outline</span>
      <p>{{ playersService.error() }}</p>
      <button (click)="clearFilters()">Tentar novamente</button>
    </div>
  }

  <!-- Featured Section -->
  @if (showingFeatured() && !playersService.isLoading()) {
    <div class="section-header">
      <h2>
        <span class="material-icons">star</span>
        Jogadores em Destaque
      </h2>
      <p>Explore jogadores de diferentes posições</p>
    </div>
  }

  <!-- Players Grid/List -->
  @if (!playersService.isLoading() && displayPlayers().length > 0) {
    <div class="players-grid" [class.list-view]="viewMode() === 'list'">
      @for (player of displayPlayers(); track player.id) {
        <div class="player-card" (click)="selectPlayer(player)">
          <div class="player-card__photo">
            <img
              [src]="getPlayerPhotoUrl(player)"
              [alt]="player.fullName"
              (error)="onImageError($event)"
            />
            <div class="player-card__position">{{ player.position }}</div>
          </div>

          <div class="player-card__info">
            <h3 class="player-name">{{ player.fullName }}</h3>
            <p class="player-position">{{ player.positionDisplay }}</p>

            <div class="player-details">
              <div class="detail-item">
                <span class="material-icons">height</span>
                <span>{{ player.height }}</span>
              </div>
              <div class="detail-item">
                <span class="material-icons">fitness_center</span>
                <span>{{ player.weight }}</span>
              </div>
            </div>

            <div class="player-team" (click)="viewTeam($event, player.team.abbreviation)">
              <img
                [src]="getTeamLogoUrl(player.team.abbreviation)"
                [alt]="player.team.name"
                class="team-logo"
                (error)="onTeamLogoError($event)"
              />
              <span class="team-name">{{ player.team.displayName }}</span>
            </div>
          </div>
        </div>
      }
    </div>

    <!-- Pagination -->
    @if (playersService.hasSearchResults() && playersService.pagination().totalPages > 1) {
      <div class="pagination">
        <button
          class="pagination-btn"
          [disabled]="!playersService.hasPreviousPage()"
          (click)="previousPage()"
        >
          <span class="material-icons">chevron_left</span>
          Anterior
        </button>

        <span class="pagination-info">
          Página {{ playersService.pagination().currentPage }} de {{ playersService.pagination().totalPages }}
        </span>

        <button
          class="pagination-btn"
          [disabled]="!playersService.hasMorePages()"
          (click)="nextPage()"
        >
          Próxima
          <span class="material-icons">chevron_right</span>
        </button>
      </div>
    }
  }

    <!-- No Results -->
    @if (!playersService.isLoading() && displayPlayers().length === 0 && !playersService.error()) {
      <div class="no-results">
        <span class="material-icons">person_search</span>
        <p>Nenhum jogador encontrado</p>
        <button (click)="clearFilters()">Limpar filtros</button>
      </div>
    }
  </div>
</div>
